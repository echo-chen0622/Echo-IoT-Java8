<section class="tb-widget-settings" [formGroup]="tripAnimationPointSettingsFormGroup">
  <fieldset class="fields-group fields-group-slider">
    <legend class="group-title" translate>widgets.maps.points-settings</legend>
    <mat-expansion-panel class="tb-settings" [expanded]="tripAnimationPointSettingsFormGroup.get('showPoints').value">
      <mat-expansion-panel-header fxLayout="row wrap">
        <mat-panel-title>
          <mat-slide-toggle formControlName="showPoints" (click)="$event.stopPropagation()"
                            fxLayoutAlign="center">
            {{ 'widgets.maps.show-points' | translate }}
          </mat-slide-toggle>
        </mat-panel-title>
        <mat-panel-description fxLayoutAlign="end center" fxHide.xs translate>
          widget-config.advanced-settings
        </mat-panel-description>
      </mat-expansion-panel-header>
      <ng-template matExpansionPanelContent>
        <section class="row-fill" fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="8px">
          <tb-color-input
            fxFlex
            formControlName="pointColor"
            icon="format_color_fill"
            label="{{ 'widgets.maps.point-color' | translate }}" openOnInput colorClearButton>
          </tb-color-input>
          <mat-form-field fxFlex class="mat-block">
            <mat-label translate>widgets.maps.point-size</mat-label>
            <input matInput type="number" min="1" formControlName="pointSize">
          </mat-form-field>
        </section>
        <mat-expansion-panel class="tb-settings" [expanded]="tripAnimationPointSettingsFormGroup.get('useColorPointFunction').value">
          <mat-expansion-panel-header fxLayout="row wrap">
            <mat-panel-title>
              <mat-slide-toggle formControlName="useColorPointFunction" (click)="$event.stopPropagation()"
                                fxLayoutAlign="center">
                {{ 'widgets.maps.use-point-color-function' | translate }}
              </mat-slide-toggle>
            </mat-panel-title>
            <mat-panel-description fxLayoutAlign="end center" fxHide.xs translate>
              widget-config.advanced-settings
            </mat-panel-description>
          </mat-expansion-panel-header>
          <ng-template matExpansionPanelContent>
            <tb-js-func formControlName="colorPointFunction"
                        [globalVariables]="functionScopeVariables"
                        [functionArgs]="['data', 'dsData', 'dsIndex']"
                        functionTitle="{{ 'widgets.maps.point-color-function' | translate }}"
                        helpId="widget/lib/map/path_point_color_fn">
            </tb-js-func>
          </ng-template>
        </mat-expansion-panel>
        <mat-expansion-panel class="tb-settings" [expanded]="tripAnimationPointSettingsFormGroup.get('usePointAsAnchor').value">
          <mat-expansion-panel-header fxLayout="row wrap">
            <mat-panel-title>
              <mat-slide-toggle formControlName="usePointAsAnchor" (click)="$event.stopPropagation()"
                                fxLayoutAlign="center">
                {{ 'widgets.maps.use-point-as-anchor' | translate }}
              </mat-slide-toggle>
            </mat-panel-title>
            <mat-panel-description fxLayoutAlign="end center" fxHide.xs translate>
              widget-config.advanced-settings
            </mat-panel-description>
          </mat-expansion-panel-header>
          <ng-template matExpansionPanelContent>
            <tb-js-func formControlName="pointAsAnchorFunction"
                        [globalVariables]="functionScopeVariables"
                        [functionArgs]="['data', 'dsData', 'dsIndex']"
                        functionTitle="{{ 'widgets.maps.point-as-anchor-function' | translate }}"
                        helpId="widget/lib/map/trip_point_as_anchor_fn">
            </tb-js-func>
          </ng-template>
        </mat-expansion-panel>
        <mat-slide-toggle formControlName="pointTooltipOnRightPanel" class="slide-block">
          {{ 'widgets.maps.independent-point-tooltip' | translate }}
        </mat-slide-toggle>
      </ng-template>
    </mat-expansion-panel>
  </fieldset>
</section>
